<!DOCTYPE html>
<html>

<head>
    <!-- <meta http-equiv="refresh" content="3; url=/"> -->
    <title>CADOALB82</title>
    <meta name="description" content="CADOLAB82" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    
</head>

<body>
    <div class="view">
        <div class="header-wrapper">
            <h1>CADOLAB82</h1>
        </div>
        <div class="group-wrapper">
            <h2>ABITAZIONE</h2>
            <div id="pulsanti">
                <button id="button1menu" href="#" class="button" type="button" onclick="window.location.href='e'">Luce Mansarda</button>
                <button id="button2menu" href="#" class="button" type="button" onclick="window.location.href='t'">Luce 2</button>
                <button id="button3menu" href="#" class="button" type="button" onclick="window.location.href='u'">Luce 3</button>
                <button id="button4menu" href="#" class="button" type="button" onclick="window.location.href='o'">Luce 4</button>
                <button id="button5menu" href="4" class="button" type="button" onclick="window.location.href='a'">Luce 5</button>
                <button id="button6menu" href="5" class="button" type="button" onclick="window.location.href='d'">Luce 6</button>
                <button id="button7menu" href="6" class="button" type="button" onclick="window.location.href='g'">Luce 7</button>
                <button id="button8menu" href="7" class="button" type="button" onclick="window.location.href='j'">Luce 8</button>
            </div>
            <table cellspacing="2" cellpadding="10" border="2" width="">
                <tr>
                    <td>NOME</td>
                    <td id="nome"></td>
                </tr>
                <tr>
                    <td>PROGETTO</td>
                    <td id="progetto"></td>
                </tr>
                <tr>
                    <td>VERSIONE</td>
                    <td id="vers"></td>
                </tr>
                <tr>
                    <td>WIFI SSID</td>
                    <td id="ssid"></td>
                </tr>
                <tr>
                    <td>RSSI</td>
                    <td id="rssi"></td>
                </tr>
                <tr>
                    <td>RSSI</td>
                    <td id="rssiPer"></td>
                </tr>
            </table>
        </div>
</body>
<script>
    
    const nome = document.getElementById('nome');
    const prog = document.getElementById('progetto');
    const versEl = document.getElementById('vers');
    const ssid = document.getElementById('ssid');
    const rssi = document.getElementById('rssi');
    const pc = document.getElementById('rssiPer');
    const buttons = document.querySelectorAll( "button[id^='button'][id$='menu']" );
    const updateStatus = () => {
  fetch('/status')
  .then(res => res.json())
  
  .then(val => {
    nome.innerHTML = val.nome;
    versEl.innerHTML = val.vers;
    prog.innerHTML = val.prog;
    ssid.innerHTML = val.ssid;
    rssi.innerHTML =val.rssi;
    pc.innerHTML = val.rssiPer;
    

    aa=val.puls;
    for (let index = 0; index < aa.length; index++) {
        const element = aa[index];
        if(aa[index]==1) {
            buttons[index].classList.add("button3")
        }else{
            buttons[index].classList.add("button4")
        }
    }
    setTimeout(updateStatus, 500);
  }).catch(err => {
    console.error('Error getting status', err);
    setTimeout(updateStatus, 500);
  });
};
updateStatus();
</script>
</html>